- name: Service
  definition: Information about software programs that run in the background and typically start with the operating system.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: service attributes
      type: information
      description: Service-specific attributes, such as start type.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: service attributes
    - name: service context
      type: information
      description: General information around services.
      relationships:
        - source_data_element: service
          relationship: started
          target_data_element: 
        - source_data_element: service
          relationship: stopped
          target_data_element: 
    - name: service creation
      type: activity
      description: A new service/daemon is created.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: service
    - name: service access
      type: activity
      description: A service/daemon was opened or accessed.
      relationships:
        - source_data_element: user
          relationship: requested access
          target_data_element: service
    - name: service modification
      type: activity
      description: A service/daemon was modified.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: service
  references:
    - https://docs.microsoft.com/en-us/dotnet/framework/windows-services/introduction-to-windows-service-applications
    - https://www.linux.com/news/introduction-services-runlevels-and-rcd-scripts/
- name: Module
  definition: Information about portable executable files, such as a dll or an executable, consisting of one or more classes and interfaces.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
  data_components:
    - name: module sections #TBD - can't include platform specific variants (elf/mach-o) here
      type: information
      description: Module file section information.
    - name: module headers
      type: information
      description: Module file header information.
    - name: module signing
      type: information
      description: Information about the signing of module files. 
    - name: module load
      type: activity
      description: A module was loaded into a process.
      relationships:
        - source_data_element: process
          relationship: loaded
          target_data_element: dll
        - source_data_element: process
          relationship: loaded
          target_data_element: elf
        - source_data_element: process
          relationship: loaded
          target_data_element: mach-o #TBD - how to specify platform-specific relationships?
        - source_data_element: process
          relationship: loaded
          target_data_element: executable
  references:
    - https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya
    - https://docs.microsoft.com/en-us/dotnet/api/system.reflection.module?view=netcore-3.1
- name: WMI object
  definition: Information about objects from the system classes, such as filters and consumers, that support Windows Management Instrumentation activitites.
  collection_layers:
    - host
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: wmi provider
      type: information
      description: The name of the provider executable/DLL used to carry out EventConsumer actions.
    - name: wmi object context 
      type: information
      description: General information around WMI.
      relationships:
        - source_data_element: wmi subscription #TBD - delete this or move it to its own component?
          relationship: created
          target_data_element:
    - name: wmi object creation
      type: activity
      description: The creation of new WMI objects on an endpoint.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: wmi filter
        - source_data_element: user
          relationship: created
          target_data_element: wmi consumer
        - source_data_element: user
          relationship: created
          target_data_element: wmi subscription
        - source_data_element: user
          relationship: created
          target_data_element: wmi binding
    - name: wmi object deletion
      type: activity
      description: The deletion of existing WMI objects on an endpoint.
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi filter
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi consumer
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi subscription
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi binding
  references:
    - https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-system-classes
- name: File
  definition: Information about file objects that represent computer resources that can be managed by the I/O system.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: file attributes
      type: information
      description: Generic file system attributes of a file (e.g., creation time).
      relationships:
        - source_data_element: process 
          relationship: modified
          target_data_element: file attributes
    - name: ntfs file attributes #TBD - how to specify platform-specific components?
      type: information
      description: Attributes specific to files stored on NTFS file systems.
      relationships:
        - source_data_element: process 
          relationship: created
          target_data_element: ntfs alternate data stream
        - source_data_element: process 
          relationship: set
          target_data_element: ntfs extended attribute
    - name: file context
      type: information
      description: General information around files.
      relationships:
        - source_data_element: driver #TBD - delete this or move it to its own component?
          relationship: loaded
          target_data_element: 
    - name: file creation
      type: activity
      description: A new file was created.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: file
    - name: file deletion
      type: activity
      description: An existing file was deleted.
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: file
        - source_data_element: user
          relationship: deleted
          target_data_element: file
    - name: file access
      type: activity
      description: An existing file was opened or accessed.
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: file
        - source_data_element: process
          relationship: accessed
          target_data_element: file
        - source_data_element: user
          relationship: requested access
          target_data_element: file
        - source_data_element: process
          relationship: requested access
          target_data_element: file
        - source_data_element: process
          relationship: raw access read #TBD - how to specify platform-specific relationships?
          target_data_element: file
    - name: file modification
      type: activity
      description: An existing file was modified.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: file
        - source_data_element: process
          relationship: renamed
          target_data_element: file
        - source_data_element: user
          relationship: modified
          target_data_element: file
  references:
    - https://docs.microsoft.com/en-us/windows/win32/fileio/file-management
- name: Named pipe
  definition: Information about mechanisms that allow inter-process communication locally or over the network. A named pipe is usually found as a file and processes attach to it.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: named pipe creation
      type: activity
      description: A named pipe is created on a system.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: pipe
    - name: named pipe connection
      type: activity
      description: Named pipe connection between a client and a server.
      relationships:
        - source_data_element: process
          relationship: connected to
          target_data_element: pipe
    - name: named pipe access
      type: activity
      description: A named pipe is accessed.
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: pipe
        - source_data_element: process
          relationship: opened handle #TBD - how to specify platform-specific relationships?
          target_data_element: pipe 
  references:
    - https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes
- name: Powershell log
  definition: Information about PowerShell operations related to PowerShell engine, providers, and cmdlets.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: powershell context
      type: information
      description: General information around powershell.
      relationships:
        - source_data_element: application host
          relationship: started
          target_data_element:
        - source_data_element: application domain
          relationship: started
          target_data_element:
    - name: powershell execution
      description: Execution of powershell commands, either locally or remotely.
      type: activity
      relationships:
        - source_data_element: user
          relationship: started
          target_data_element: application host
        - source_data_element: process
          relationship: executed
          target_data_element: command
        - source_data_element: process
          relationship: executed
          target_data_element: remote command #TBD - how to specify collection-layer (network) centric relationships?
  references:
    - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7
- name: Windows active directory
  definition: Information about objects on a domain network such as a user, a group, or a workstation.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: active directory kerberos authentication request #TBD - how to specify collection-layer (network) centric components?
      type: activity
      description: A Kerberos authentication ticket was requested.
    - name: active directory kerberos authentication service request #TBD - how to specify collection-layer (network)  centric components?
      type: activity
      description: A Kerberos service ticket was requested.
    - name: active directory ntlm authentication request #TBD - how to specify collection-layer (network) centric components?
      type: activity
      description: An NTLM authentication request was made.
    - name: active directory service creation
      description: An active directory service was created.
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: ad object
    - name: active directory service deletion
      type: activity
      description: An active directory service was deleted
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: ad object
        - source_data_element: user
          relationship: undeleted
          target_data_element: ad object
    - name: active directory service access
      type: activity
      description: An active directory service was accessed.
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: ad object
        - source_data_element: user
          relationship: requested access
          target_data_element: ad object
        - source_data_element: process
          relationship: requested access
          target_data_element: ad object
    - name: active directory service modification
      type: activity
      description: An active directory service was modified.
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: ad object
  references:
    - https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/ad-ds-getting-started
- name: Windows registry
  definition: Information about configuration data used by applications and system components.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
  data_components:
    - name: windows registry key creation
      type: activity
      description: A registry key/value was created locally on an endpoint or remotely using the remote registry service (implemented over DCE/RPC).
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key 
        - source_data_element: process
          relationship: created
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value 
    - name: windows registry key deletion
      type: activity
      description: A registry key/value was deleted from an endpoint or remotely using the remote registry service (implemented over DCE/RPC). 
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: windows registry key
        - source_data_element: process
          relationship: deleted
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key
        - source_data_element: process
          relationship: deleted
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value
    - name: windows registry key modification
      type: activity
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: windows registry key
        - source_data_element: process
          relationship: modified
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value
        - source_data_element: user
          relationship: modified
          target_data_element: windows registry key
        - source_data_element: user
          relationship: modified
          target_data_element: windows registry key value
    - name: windows registry key access
      type: activity
      description: A registry key/value was accessed. 
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: windows registry key
        - source_data_element: user
          relationship: accessed
          target_data_element: windows registry key
        - source_data_element: process
          relationship: requested access
          target_data_element: windows registry key
        - source_data_element: user
          relationship: requested access
          target_data_element: windows registry key
  references:
    - https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry
- name: Logon session
  definition: Information about logon sessions being created or terminated by accounts (Local or Domain), interactively or over the network, in order to interact with network resources, applications, or services. 
  collection_layers:
    - host
    - network
    - cloud
  platforms:
    - Windows
    - Linux
    - MacOS
    - AWS
  contributors: 
    - ATT&CK
  data_components:
    - name: logon session context
      type: information
      description: General information about logon sessions.
      relationships:
        - source_data_element: logon session
          relationship: modified
          target_data_element:
    - name: logon session creation
      type: activity
      description: A logon session for a user was created.
      relationships:
        - source_data_element: user
          relationship: requested creation
          target_data_element: logon session
        - source_data_element: user
          relationship: requested logon session creation from
          target_data_element: ip
        - source_data_element: user
          relationship: requested logon session creation from
          target_data_element: port
        - source_data_element: user
          relationship: created
          target_data_element: logon session #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: created
          target_data_element: local logon session
        - source_data_element: user
          relationship: created
          target_data_element: domain logon session
        - source_data_element: user
          relationship: created
          target_data_element: cloud logon session
        - source_data_element: user
          relationship: created logon session from
          target_data_element: ip
        - source_data_element: user
          relationship: created logon session from
          target_data_element: port
        - source_data_element: user
          relationship: failed creation
          target_data_element: logon session
        - source_data_element: user
          relationship: failed logon session creation from
          target_data_element: ip
        - source_data_element: user
          relationship: failed logon session creation from
          target_data_element: port
    - name: logon session termination
      type: activity
      description: A logon session for a user was terminated.
      relationships:
        - source_data_element: user
          relationship: requested termination
          target_data_element: logon session
        - source_data_element: user
          relationship: terminated
          target_data_element: logon session
  references:
    - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/basic-audit-logon-events
- name: Process
  definition: Information about instances of computer programs that are being executed by at least one thread.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: process open files
      type: information
      description: The list of files opened by a process.
    - name: process open pipes
      type: information
      description: The list of pipes opened by a process.
    - name: process environment variables
      type: information
      description: The set of environment variables defined for a process.
    - name: process execution
      type: information
      description: Information about the execution of a process, such as the API calls that it makes.
      relationships:
        - source_data_element: process
          relationship: executes
          target_data_element: api call
        - source_data_element: process
          relationship: executes
          target_data_element: system call
    - name: process context #TBD - delete this or move it to its own component?
      type: information
      description: General information about a process.
      relationships:
        - source_data_element: process
          relationship: terminated 
          target_data_element: 
    - name: process creation
      description: The creation of a new process.
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: process
        - source_data_element: process
          relationship: created
          target_data_element: process
        - source_data_element: process
          relationship: created
          target_data_element: thread
        - source_data_element: process
          relationship: created
          target_data_element: remote thread
    - name: process termination
      description: The termination of an existing process.
      type: activity
      relationships:
        - source_data_element: user
          relationship: terminated
          target_data_element: process
    - name: process modification
      description: The modification of an existing process.
      type: activity
      relationships:
        - source_data_element: process
          relationship: wrote to
          target_data_element: process
    - name: process access
      description: A process opens or accesses another process.
      type: activity
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: process
        - source_data_element: process
          relationship: requested access
          target_data_element: process
        - source_data_element: process
          relationship: opened handle #TBD - how to specify platform-specific relationships?
          target_data_element: process
    - name: process network connection
      type: activity
      description: Information about network connections initiated by processes.
      relationships:
        - source_data_element: process
          relationship: connected to
          target_data_element: port
        - source_data_element: process
          relationship: connected to
          target_data_element: ip
        - source_data_element: process
          relationship: connected to
          target_data_element: host
        - source_data_element: process
          relationship: connected from
          target_data_element: port
        - source_data_element: process
          relationship: connected from
          target_data_element: ip
        - source_data_element: process
          relationship: connected from
          target_data_element: host
        - source_data_element: user
          relationship: connected to
          target_data_element: port
        - source_data_element: user
          relationship: connected to
          target_data_element: ip
        - source_data_element: user
          relationship: connected to
          target_data_element: host
        - source_data_element: user
          relationship: connected from
          target_data_element: port
        - source_data_element: user
          relationship: connected from
          target_data_element: ip
        - source_data_element: user
          relationship: connected from
          target_data_element: host
        - source_data_element: host
          relationship: blocked connection on #TBD - wouldn't this and other blocked/allowed relationships make more sense for a firewall data source?
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: ip
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: port
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: ip
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: port
        - source_data_element: process
          relationship: attempted connection to
          target_data_element: ip
        - source_data_element: process
          relationship: attempted connection to
          target_data_element: port
        - source_data_element: process
          relationship: attempted connection from
          target_data_element: ip
        - source_data_element: process
          relationship: attempted connection from
          target_data_element: port
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: process
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: ip
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: port
        - source_data_element: process
          relationship: listened on
          target_data_element: port
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: process
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: ip
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: port
        - source_data_element: process
          relationship: attempted to listen on
          target_data_element: port
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: process
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: ip
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: port
        - source_data_element: process
          relationship: bound to
          target_data_element: port
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: process
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: ip
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: port
        - source_data_element: process
          relationship: attempted to bind on
          target_data_element: port
  references:
    - https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads
- name: User Account
  definition: Security principal or entity that represents a person or machine and can be authenticated by an operating system or platform.
  collection_layers:
    - host
    - cloud
  platforms:
    - Windows
    - Linux
    - MacOS
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: user account creation
      type: activity
      description: A new user account was created.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: user #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: created
          target_data_element: local user 
        - source_data_element: user
          relationship: created
          target_data_element: domain user
        - source_data_element: user
          relationship: created
          target_data_element: cloud user
    - name: user account deletion
      type: activity
      description: An existing user account was deleted.
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: user #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: deleted
          target_data_element: local user
        - source_data_element: user
          relationship: deleted
          target_data_element: domain user
        - source_data_element: user
          relationship: deleted
          target_data_element: cloud user
    - name: user account enable
      description: An existing user account was enabled.
      type: activity
      relationships:
        - source_data_element: user
          relationship: enabled
          target_data_element: user
    - name: user account disable
      type: activity
      description: An existing user account was disabled.
      relationships:
        - source_data_element: user
          relationship: disabled
          target_data_element: user
    - name: user account lock
      type: activity
      description: A user account was locked.
      relationships:
        - source_data_element: user
          relationship: locked
          target_data_element: user
    - name: user account unlock
      type: activity
      description: A user account was unlocked.
      relationships:
        - source_data_element: user
          relationship: unlocked
          target_data_element: user
    - name: user account modification
      type: activity
      description: An existing user account was modified.
      relationships:
        - source_data_element: user
          relationship: requested modification
          target_data_element: user
        - source_data_element: user
          relationship: modified
          target_data_element: user
        - source_data_element: user
          relationship: granted access
          target_data_element: user
        - source_data_element: user
          relationship: removed access
          target_data_element: user
    - name: user account logon
      type: activity
      description: A user account logged onto a system. 
      relationships:
        - source_data_element: user
          relationship: logged into
          target_data_element: application
        - source_data_element: local user
          relationship: logged onto
          target_data_element: endpoint
        - source_data_element: domain user
          relationship: logged onto
          target_data_element: endpoint
        - source_data_element: cloud user 
          relationship: logged onto #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
        - source_data_element: cloud user
          relationship: console logged onto #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
    - name: user account logoff
      type: activity
      description: A user account logged off a system. 
      relationships:
        - source_data_element: user
          relationship: logged off from
          target_data_element: application
        - source_data_element: local user
          relationship: logged offfrom
          target_data_element: endpoint
        - source_data_element: domain user
          relationship: logged off from #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: endpoint
        - source_data_element: cloud user
          relationship: logged off from #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
  references:
    - https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/security-principals
- name: Scheduled Task
  definition: Information about scheduled work that the Windows Task Scheduler service performs.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: scheduled task creation
      type: activity
      description: A new scheduled task was created.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task deletion
      type: activity
      description: An existing scheduled task was deleted.
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task enable
      type: activity
      description: An existing task was enabled.
      relationships:
        - source_data_element: user
          relationship: enabled
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely enabled #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task disable
      type: activity
      description: An existing task was disabled.
      relationships:
        - source_data_element: user
          relationship: disabled
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely disabled #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: schedule task modification
      type: activity
      description: An existing scheduled task was modified (e.g., the executable launched by the task was changed).
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
  references:
    - https://docs.microsoft.com/en-us/windows/win32/taskschd/tasks
- name: DNS
  definition: Information about the Domain Name System (DNS) protocol that provides resources (Such as computers or services) names-to- IP address mapping name resolution services.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: dns query execution
      type: activity
      relationships:
        - source_data_element: process
          relationship: executed
          target_data_element: dns query
  references:
    - https://docs.microsoft.com/en-us/windows-server/networking/dns/dns-top
- name: Network share
  definition: Information associated with computer resources made available from one host to other hosts on a computer network.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: exported network shares #TBD - how to specify collection-layer (linux, macos) centric components?
      type: information
      description: A list of the NFS shares exported on the system.
    - name: network share creation
      type: activity
      description: A new network share was created.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: network share
        - source_data_element: process
          relationship: created
          target_data_element: network share
        - source_data_element: process
          relationship: created
          target_data_element: smb network share
        - source_data_element: process
          relationship: created
          target_data_element: nfs network share
    - name: network share deletion
      type: activity
      description: An existing network share was deleted.
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: network share
        - source_data_element: process
          relationship: deleted
          target_data_element: network share
        - source_data_element: process
          relationship: deleted
          target_data_element: smb network share
        - source_data_element: process
          relationship: deleted
          target_data_element: nfs network share
    - name: network share modification
      type: activity
      description: An existing network share was modified.
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: network share
        - source_data_element: process
          relationship: modified
          target_data_element: network share
        - source_data_element: process
          relationship: modified
          target_data_element: smb network share
        - source_data_element: process
          relationship: modified
          target_data_element: nfs network share
    - name: network share access
      type: activity
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: network share
        - source_data_element: process
          relationship: accessed
          target_data_element: network share
- name: Firmware
  definition: Information associated with computer software that provides the low-level control for a device's specific hardware.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: firmware modification
      type: activity
      description: The firmware of a system component was modified.
        - source_data_element: user
          relationship: modified
          target_data_element: firmware
        - source_data_element: process
          relationship: modified
          target_data_element: network share
    - name: acpi tables #TBD - how to specify platform-specific (linux, macos) components?
      type: information
      description: Firmware ACPI metadata and content. 
    - name: bios
      type: information
      description: Information (e.g., key/value pairs) extracted from the BIOS on an endpoint.
    - name: smbios
      type: information
      description: Information about the System Management BIOS (SMBIOS) on an endpoint.
- name: Driver
  definition: Information associated with device drivers, or computer programs that operate or control a particular type of device that is attached to a computer.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: driver iokit registry #TBD - how to specify platform-specific (macos) components?
      type: information
      description: The I/O Registry is a dynamic database that describes a collection of “live” objects (nubs or drivers) and tracks the provider-client relationships between them.
    - name: driver issue #TBD - how to specify platform-specific (windows) components?
      type: information
      description: The system reported an issue with a device driver.
    - name: driver integrity page hash invalid #TBD - how to specify platform-specific (windows) components?
      type: information
      description: Information about device driver integrity checks.
    - name: driver integrity check failure #TBD - how to specify platform-specific (windows) components?
      type: information
      description: A code integrity check failed for a signed device driver.
    - name: driver load
      type: activity
      description: A driver was loaded.
      relationships:
        - source_data_element: process
          relationship: loaded
          target_data_element: user-mode driver
        - source_data_element: process
          relationship: loaded
          target_data_element: kernel-mode driver
    - name: driver unload
      type: activity
      description: A driver was unloaded.
      relationships:
        - source_data_element: process
          relationship: unloaded
          target_data_element: user-mode driver
        - source_data_element: process
          relationship: unloaded
          target_data_element: kernel-mode driver
- name: Log file
  definition: Information associated with system log files, such as Windows application logs.
  collection_layers:
    - cloud
    - host
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: log file erasure
      type: activity
      description: Erasure/clearing of a log file.
      relationships:
        - source_data_element: process
          relationship: erased  #TBD - how to specify platform-specific (windows) relationships?
          target_data_element: application log 
        - source_data_element: process
          relationship: erased #TBD - how to specify platform-specific (windows) relationships?
          target_data_element: system log
        - source_data_element: process
          relationship: erased #TBD - how to specify platform-specific (windows) relationships?
          target_data_element: audit log
- name: Config
  definition: Information associated with system configuration items.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: arp cache
      type: information
      description: The contents of the Address Resolution Protocol (ARP) cache on the endpoint.
    - name: name resolution
      type: information
      description: Name resolution configuration, such as /etc/hosts.
    - name: supported protocols
      type: information
      description: Supported network protocols, such as /etc/protocols.
    - name: port mappings
      type: information
      description: Protocol/port mappings, such as /etc/services.
    - name: active directory local config
      type: information #TBD - how to specify platform-specific (macos) components?
      description: Local Active Directory configuration items.
    - name: ssh authorized keys
      type: information #TBD - how to specify platform-specific (macos, linux) components?
      description: Data from the SSH authorized_keys file.
    - name: ssh known hosts
      type: information #TBD - how to specify platform-specific (macos, linux) components?
      description: Data from the SSH known_hosts file.
    - name: environment variables
      type: information #TBD - how to specify platform-specific (windows) components?
      description: The set of system-wide environment variables defined on an endpoint.
    - name: audit policy modification
      type: activity
      description: System audit policy was changed.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: audit policy
- name: Cron
  definition: Information associated with the cron job scheduler.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: crontab
      type: information
      description: The textual contents of a crontab as retreived from an endpoint.
    - name: crontab modification
      type: activity
      description: The modification of a crontab on an endpoint.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: crontab
- name: Bits
  definition: Information associated with the Windows Background Intelligent Transfer Service (BITS).
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: bits job creation
      type: activity
      description: A new Windows Background Intelligent Transfer Service (BITS) job was created on an endpoint or remotely using the WinRM protocol.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: bits job
- name: At Task
  definition: Information about scheduled tasks created using the 'at' utility. 
  collection_layers:
    - host
    - network
  platforms:
    - Windows
    - Linux
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: at task creation
      type: activity
      description: A new at task was created.
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: at task
        - source_data_element: process
          relationship: created
          target_data_element: at task
    - name: at task deletion
      type: activity
      description: An existing at task was deleted.
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: at task
        - source_data_element: process
          relationship: deleted
          target_data_element: at task
- name: Firewall
  definition: Information associated with the network security system that monitors and controls incoming and outgoing network traffic based on predetermined security rules.
  collection_layers:
    - cloud
    - host
  platforms:
    - AWS
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: firewall setting modification
      type: activity
      description: A setting was changed in a firewall running locally on an endpoint or remotely in a cloud environment.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: firewall setting
    - name: firewall group policy modification #TBD - how to specify platform-specific (windows) components?
      type: activity
      description: A modification to the Windows Firewall group policy was made.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: firewall group policy
    - name: firewall rule creation
      type: activity
      description: A new firewall rule was created on an endpoint or in a cloud environment.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: firewall rule
    - name: firewall rule deletion
      type: activity
      description: An existing firewall rule was deleted from an endpoint or a cloud environment.
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: firewall rule
    - name: firewall blocked connection
      type: information
      description: The firewall blocked an incoming or outgoing connection on an endpoint.
    - name: firewall rule list
      type: information
      description: The list of rules currently running on a firewall.
- name: Snapshot
  definition: Information associated with the state of a system at a particular point in time.
  collection_layers:
    - cloud
  platforms:
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: vm snapshot creation
      type: activity
      description: A snapshot of a Virtual Machine (VM) was created.
    - name: volume snapshot creation
      type: activity
      description: A snapshot of a storage volume was created.
    - name: vm snapshot deletion
      type: activity
      description: A snapshot of a Virtual Machine (VM) was deleted.
    - name: volume snapshot deletion
      type: activity
      description: A snapshot of a storage volume was deleted.
    - name: snapshot permissions modification
      type: activity
      description: Permission settings for a snapshot were modified. 
- name: browser
  definition: Information associated with web browsers and browser extensions.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: chrome browser extensions
      type: information
      description: Installed Chrome browser extensions.
    - name: firefox browser extensions
      type: information
      description: Installed Firefox browser extensions and addons.
    - name: ie browser extensions #TBD - how to specify platform-specific (windows) components?
      type: information
      description: Installed Internet Explorer browser extensions and addons.
    - name: safari browser extensions
      type: information
      description: Installed Safari browser extensions and addons.
- name: Anti-malware
  definition: Information associated with anti-malware security software.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: anti-malware enable
      type: activity
      description: Anti-malware software was enabled.
      relationships:
        - source_data_element: process
          relationship: enabled
          target_data_element: anti-malware
    - name: anti-malware disable
      type: activity
      description: Anti-malware software was disabled.
      relationships:
        - source_data_element: process
          relationship: disabled
          target_data_element: anti-malware
    - name: anti-malware engine modification
      type: activity
      description: Anti-malware security software engine configuration modification.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: anti-malware engine configuration
    - name: anti-malware configuration modification
      type: activity
      description: Anti-malware security software configuration modification (e.g., disabling real-time protection).
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: anti-malware configuration
- name: Volume
  definition: Information associated with accessible storage areas with a single file system, typically (though not necessarily) resident on a single partition of a hard disk.
  collection_layers:
    - cloud
    - host
  platforms:
    - AWS
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: volume creation
      type: activity
      description: A new storage volume was created.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: volume
    - name: volume deletion
      type: activity
      description: An existing storage volume was deleted.
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: volume
    - name: volume modification
      type: activity
      description: An existing storage volume was modified.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: volume
    - name: volume detachment
      type: activity #TBD - how to specify platform-specific (aws) components?
      description: A volume was detached from a system.
- name: Hardware
  definition: Information associated with physical system hardware, such as external devices.
  collection_layers:
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: usb device list
      type: information
      description: The list of USB devices currently plugged into an endpoint.
    - name: usb device installation
      type: activity
      description:  A new external USB device was installed on the endpoint.
    - name: hardware configuration modification
      type: activity
      description: The configuration of a hardware device was modified (e.g., a NIC was placed into promiscuous mode).
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: hardware configuration
- name: Certificate
  description: Information associated with PKI certificates and certificate authorities.
  collection_layers:
    - cloud
    - host
  platforms:
    - Linux
    - MacOS
    - Windows
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: certificate authorities
      type: information
      description: Information regarding certificate authorities on a system.
    - name: certificate addition
      type: activity
      description: A new certificate was added (e.g., to a certificate store).
      relationships:
        - source_data_element: process
          relationship: added
          target_data_element: certificate
    - name: server certificate addition
      type: activity #TBD - how to specify platform-specific (aws) components?
      description: A new server certificate was added/uploaded
    - name: certificate deletion
      type: activity
      description: An existing certificate was deleted.
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: certificate
    - name: server certificate deletion
      type: activity #TBD - how to specify platform-specific (aws) components?
      description: An existing server certificate was deleted.
- name: Virtual appliance
  definition: Information associated with cloud virtual appliances.
  collection_layers:
    - cloud
  platforms: 
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: virtual appliance creation
      type: activity
      description: The creation of a new virtual appliance in a cloud environment.
    - name: ami virtual appliance creation #TBD - how to specify platform-specific (aws) components?
      type: activity 
      description: A new Amazon EBS-backed Amazon Machine Image (AMI) was created.
    - name: virtual appliance modification
      type: activity
      description: The modification of an existing virtual appliance in a cloud environment.
    - name: ami virtual appliance modification #TBD - how to specify platform-specific (aws) components?
      type: activity
      description: The modification of an existing virtual appliance in a cloud environment.
- name: RDP session
  definition: Information associated with Remote Desktop Protocol (RDP) sessions.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: rdp session creation failure
      type: information
      description: An attempted RDP logon and session instantiation which failed (e.g., due to invalid credentials).
    - name: rdp session creation
      type: activity
      description: Creation/establishiment of an RDP session.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: rdp session
    - name: rdp session termination
      type: activity
      description: Termination of an existing RDP session.
      relationships:
        - source_data_element: process
          relationship: terminated
          target_data_element: rdp session
- name: Status
  definition: Information associated with general endpoint system status (e.g., DHCP leases).
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: ip address lease
      type: activity
      description: A new IP address was leased to the client (e.g., via DHCP).
    - name: wlan connection
      type: activity
      description: A successful connection to a wireless network was made.
    - name: wlan disconnection
      type: activity
      description: A disconnection from a wireless network was made.
    - name: wlan security success
      type: activity
      description: Wireless security (i.e., encryption) succeeded. 
    - name: windows update agent installation #TBD - how to specify platform-specific (windows) components?
      type: activity
      description: The Windows Update agent succesfully installed an update.
    - name: ntp time sync
      type: activity
      description: An NTP time synchronization exchange occurred.
    - name: os version
      type: information
      description: The version of the running operating system.
    - name: os patch level
      type: information
      description: The patch level/service pack version of the running operating system.
    - name: processor info
      type: information
      description: Information about the processor (CPU) running on the current system.
- name: File system
  definition: Information associated with how files are stored and organized.
  collection_layers:
    - cloud
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: file system creation
      type: activity
      description: The creation of a new, empty file system.
    - name: file system deletion
      type: activity
      description: The deletion of an existing file system.
    - name: mount point creation
      type: activity
      description: The creation of a new mount point/target for a file system on an endpoint or in a cloud environment.
    - name: mount point deletion
      type: activity
      description: The deletion of an existing mount point/target for a file system on an endpoint or in a cloud environment.
- name: kernel
  definition: Information associated with the computer program at the core of a computer's operating system.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: kernel active info
      type: information
      description: Information about the running kernel on a system.
    - name: kernel module list
      type: information
      description: A list of kernel modules both loaded and within the load search path.
    - name: kernel module load #TBD - how to specify platform-specific (macos, linux) components?
      type: activity
      description: A new kernel module was loaded on an endpoint.
      relationships:
        - source_data_element: process
          relationship: loaded
          target_data_element: kernel module
    - name: kernel module unload #TBD - how to specify platform-specific (macos, linux) components?
      type: activity
      description: An existing kernel module was unloaded from an endpoint.
      relationships:
        - source_data_element: process
          relationship: unloaded
          target_data_element: kernel module
- name: Partition
  definition: Information associated with disk storage regions.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: partition creation
      type: activity
      description: The creation of a new partition.
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: partition
    - name: partition deletion
      type: activity
      description: The deletion of an existing partition.
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: partition
    - name: partition mbr modification
      type: activity
      description: The modification of the Master Boot Record (MBR) on a partition.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: partition mbr
    - name: partition vbr modification
      type: activity
      description: The modification of the Volume Boot Record (VBR) on a partition.
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: partition vbr