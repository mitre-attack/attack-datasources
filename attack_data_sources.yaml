- name: Service
  definition: Information about software programs that run in the background and typically start with the operating system.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: service attributes
      type: information
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: service attributes
    - name: service context
      type: information
      relationships:
        - source_data_element: service
          relationship: started
          target_data_element: 
        - source_data_element: service
          relationship: stopped
          target_data_element: 
    - name: service creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: service
    - name: service access
      type: activity
      relationships:
        - source_data_element: user
          relationship: requested access
          target_data_element: service
    - name: service modification
      type: activity
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: service
  references:
    - https://docs.microsoft.com/en-us/dotnet/framework/windows-services/introduction-to-windows-service-applications
    - https://www.linux.com/news/introduction-services-runlevels-and-rcd-scripts/
- name: Module
  definition: Information about portable executable files, such as a dll or an executable, consisting of one or more classes and interfaces.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
  data_components:
    - name: module sections #TBD - can't include platform specific variants (elf/mach-o) here
      type: information
    - name: module headers
      type: information
    - name: module signing
      type: information
    - name: module load
      type: activity
      relationships:
        - source_data_element: process
          relationship: loaded
          target_data_element: dll
        - source_data_element: process
          relationship: loaded
          target_data_element: elf
        - source_data_element: process
          relationship: loaded
          target_data_element: mach-o #TBD - how to specify platform-specific relationships?
        - source_data_element: process
          relationship: loaded
          target_data_element: executable
  references:
    - https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya
    - https://docs.microsoft.com/en-us/dotnet/api/system.reflection.module?view=netcore-3.1
- name: WMI object
  definition: Information about objects from the system classes, such as filters and consumers, that support Windows Management Instrumentation activitites.
  collection_layers:
    - host
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: wmi provider
      type: information
    - name: wmi object context 
      type: information
      relationships:
        - source_data_element: wmi subscription #TBD - delete this or move it to its own component?
          relationship: created
          target_data_element:
    - name: wmi object creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: wmi filter
        - source_data_element: user
          relationship: created
          target_data_element: wmi consumer
        - source_data_element: user
          relationship: created
          target_data_element: wmi subscription
        - source_data_element: user
          relationship: created
          target_data_element: wmi binding
    - name: wmi object deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi filter
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi consumer
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi subscription
        - source_data_element: user
          relationship: deleted
          target_data_element: wmi binding
  references:
    - https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-system-classes
- name: File
  definition: Information about file objects that represent computer resources that can be managed by the I/O system.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: file attributes
      type: information
      relationships:
        - source_data_element: process 
          relationship: modified
          target_data_element: file attributes
    - name: ntfs file attributes #TBD - how to specify platform-specific components?
      type: information
      relationships:
        - source_data_element: process 
          relationship: created
          target_data_element: ntfs alternate data stream
        - source_data_element: process 
          relationship: set
          target_data_element: ntfs extended attribute
    - name: file context
      type: information
      relationships:
        - source_data_element: driver #TBD - delete this or move it to its own component?
          relationship: loaded
          target_data_element: 
    - name: file creation
      type: activity
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: file
    - name: file deletion
      type: activity
      relationships:
        - source_data_element: process
          relationship: deleted
          target_data_element: file
        - source_data_element: user
          relationship: deleted
          target_data_element: file
    - name: file access
      type: activity
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: file
        - source_data_element: process
          relationship: accessed
          target_data_element: file
        - source_data_element: user
          relationship: requested access
          target_data_element: file
        - source_data_element: process
          relationship: requested access
          target_data_element: file
        - source_data_element: process
          relationship: raw access read #TBD - how to specify platform-specific relationships?
          target_data_element: file
    - name: file modification
      type: activity
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: file
        - source_data_element: process
          relationship: renamed
          target_data_element: file
        - source_data_element: user
          relationship: modified
          target_data_element: file
  references:
    - https://docs.microsoft.com/en-us/windows/win32/fileio/file-management
- name: Named pipe
  definition: Information about mechanisms that allow inter-process communication locally or over the network. A named pipe is usually found as a file and processes attach to it.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: named pipe creation
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: pipe
    - name: named pipe connection
      relationships:
        - source_data_element: process
          relationship: connected to
          target_data_element: pipe
    - name: named pipe access
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: pipe
        - source_data_element: process
          relationship: opened handle #TBD - how to specify platform-specific relationships?
          target_data_element: pipe 
  references:
    - https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes
- name: Powershell log
  definition: Information about PowerShell operations related to PowerShell engine, providers, and cmdlets.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: powershell context
      type: information
      relationships:
        - source_data_element: application host
          relationship: started
          target_data_element:
        - source_data_element: application domain
          relationship: started
          target_data_element:
    - name: powershell execution
      type: activity
      relationships:
        - source_data_element: user
          relationship: started
          target_data_element: application host
        - source_data_element: process
          relationship: executed
          target_data_element: command
        - source_data_element: process
          relationship: executed
          target_data_element: remote command #TBD - how to specify collection-layer (network) centric relationships?
  references:
    - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7
- name: Windows active directory
  definition: Information about objects on a domain network such as a user, a group, or a workstation.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: active directory kerberos authentication request #TBD - how to specify collection-layer (network) centric components?
      type: activity
    - name: active directory kerberos authentication service request #TBD - how to specify collection-layer (network)  centric components?
      type: activity
    - name: active directory ntlm authentication request #TBD - how to specify collection-layer (network) centric components?
      type: activity
    - name: active directory service creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: ad object
    - name: active directory service deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: ad object
        - source_data_element: user
          relationship: undeleted
          target_data_element: ad object
    - name: active directory service access
      type: activity
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: ad object
        - source_data_element: user
          relationship: requested access
          target_data_element: ad object
        - source_data_element: process
          relationship: requested access
          target_data_element: ad object
    - name: active directory service modification
      type: activity
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: ad object
  references:
    - https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/ad-ds-getting-started
- name: Windows registry
  definition: Information about configuration data used by applications and system components.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
  data_components:
    - name: windows registry key creation
      type: activity
      relationships:
        - source_data_element: process
          relationship: created
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key 
        - source_data_element: process
          relationship: created
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value 
    - name: windows registry key deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: windows registry key
        - source_data_element: process
          relationship: deleted
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key
        - source_data_element: process
          relationship: deleted
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value
    - name: windows registry key modification
      type: activity
      relationships:
        - source_data_element: process
          relationship: modified
          target_data_element: windows registry key
        - source_data_element: process
          relationship: modified
          target_data_element: windows registry key value
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: windows registry key value
        - source_data_element: user
          relationship: modified
          target_data_element: windows registry key
        - source_data_element: user
          relationship: modified
          target_data_element: windows registry key value
    - name: Windows registry key access
      type: activity
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: windows registry key
        - source_data_element: user
          relationship: accessed
          target_data_element: windows registry key
        - source_data_element: process
          relationship: requested access
          target_data_element: windows registry key
        - source_data_element: user
          relationship: requested access
          target_data_element: windows registry key
  references:
    - https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry
- name: Logon session
  definition: Information about logon sessions being created or terminated by accounts (Local or Domain), interactively or over the network, in order to interact with network resources, applications, or services. 
  collection_layers:
    - host
    - network
    - cloud
  platforms:
    - Windows
    - Linux
    - MacOS
    - AWS
  contributors: 
    - ATT&CK
  data_components:
    - name: logon session context
      type: information
      relationships:
        - source_data_element: logon session
          relationship: modified
          target_data_element:
    - name: logon session creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: requested creation
          target_data_element: logon session
        - source_data_element: user
          relationship: requested logon session creation from
          target_data_element: ip
        - source_data_element: user
          relationship: requested logon session creation from
          target_data_element: port
        - source_data_element: user
          relationship: created
          target_data_element: logon session #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: created
          target_data_element: local logon session
        - source_data_element: user
          relationship: created
          target_data_element: domain logon session
        - source_data_element: user
          relationship: created
          target_data_element: cloud logon session
        - source_data_element: user
          relationship: created logon session from
          target_data_element: ip
        - source_data_element: user
          relationship: created logon session from
          target_data_element: port
        - source_data_element: user
          relationship: failed creation
          target_data_element: logon session
        - source_data_element: user
          relationship: failed logon session creation from
          target_data_element: ip
        - source_data_element: user
          relationship: failed logon session creation from
          target_data_element: port
    - name: logon session termination
      type: activity
      relationships:
        - source_data_element: user
          relationship: requested termination
          target_data_element: logon session
        - source_data_element: user
          relationship: terminated
          target_data_element: logon session
  references:
    - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/basic-audit-logon-events
- name: Process
  definition: Information about instances of computer programs that are being executed by at least one thread.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: process open files
      type: information
    - name: process open pipes
      type: information
    - name: process environment variables
      type: information
    - name: process execution
      type: information
      relationships:
        - source_data_element: process
          relationship: executes
          target_data_element: api call
        - source_data_element: process
          relationship: executes
          target_data_element: system call
    - name: process context #TBD - delete this or move it to its own component?
      type: information
      relationships:
        - source_data_element: process
          relationship: terminated 
          target_data_element: 
    - name: process creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: process
        - source_data_element: process
          relationship: created
          target_data_element: process
        - source_data_element: process
          relationship: created
          target_data_element: thread
        - source_data_element: process
          relationship: created
          target_data_element: remote thread
    - name: process termination
      type: activity
      relationships:
        - source_data_element: user
          relationship: terminated
          target_data_element: process
    - name: process modification
      type: activity
      relationships:
        - source_data_element: process
          relationship: wrote to
          target_data_element: process
    - name: process access
      type: activity
      relationships:
        - source_data_element: process
          relationship: accessed
          target_data_element: process
        - source_data_element: process
          relationship: requested access
          target_data_element: process
        - source_data_element: process
          relationship: opened handle #TBD - how to specify platform-specific relationships?
          target_data_element: process
    - name: process network connection
      type: activity
      relationships:
        - source_data_element: process
          relationship: connected to
          target_data_element: port
        - source_data_element: process
          relationship: connected to
          target_data_element: ip
        - source_data_element: process
          relationship: connected to
          target_data_element: host
        - source_data_element: process
          relationship: connected from
          target_data_element: port
        - source_data_element: process
          relationship: connected from
          target_data_element: ip
        - source_data_element: process
          relationship: connected from
          target_data_element: host
        - source_data_element: user
          relationship: connected to
          target_data_element: port
        - source_data_element: user
          relationship: connected to
          target_data_element: ip
        - source_data_element: user
          relationship: connected to
          target_data_element: host
        - source_data_element: user
          relationship: connected from
          target_data_element: port
        - source_data_element: user
          relationship: connected from
          target_data_element: ip
        - source_data_element: user
          relationship: connected from
          target_data_element: host
        - source_data_element: host
          relationship: blocked connection on #TBD - wouldn't this and other blocked/allowed relationships make more sense for a firewall data source?
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: ip
        - source_data_element: host
          relationship: blocked connection to
          target_data_element: port
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: process
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: ip
        - source_data_element: host
          relationship: blocked connection from
          target_data_element: port
        - source_data_element: process
          relationship: attempted connection to
          target_data_element: ip
        - source_data_element: process
          relationship: attempted connection to
          target_data_element: port
        - source_data_element: process
          relationship: attempted connection from
          target_data_element: ip
        - source_data_element: process
          relationship: attempted connection from
          target_data_element: port
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: process
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: ip
        - source_data_element: host
          relationship: permitted listener on
          target_data_element: port
        - source_data_element: process
          relationship: listened on
          target_data_element: port
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: process
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: ip
        - source_data_element: host
          relationship: blocked listener on
          target_data_element: port
        - source_data_element: process
          relationship: attempted to listen on
          target_data_element: port
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: process
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: ip
        - source_data_element: host
          relationship: permitted local port bind on
          target_data_element: port
        - source_data_element: process
          relationship: bound to
          target_data_element: port
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: process
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: ip
        - source_data_element: host
          relationship: blocked local port bind on
          target_data_element: port
        - source_data_element: process
          relationship: attempted to bind on
          target_data_element: port
  references:
    - https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads
- name: User Account
  definition: Security principal or entity that represents a person or machine and can be authenticated by an operating system or platform.
  collection_layers:
    - host
    - cloud
  platforms:
    - Windows
    - Linux
    - MacOS
    - AWS
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: user account creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: user #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: created
          target_data_element: local user 
        - source_data_element: user
          relationship: created
          target_data_element: domain user
        - source_data_element: user
          relationship: created
          target_data_element: cloud user
    - name: user account deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: user #TBD - deprecate in favor of more specific variants below?
        - source_data_element: user
          relationship: deleted
          target_data_element: local user
        - source_data_element: user
          relationship: deleted
          target_data_element: domain user
        - source_data_element: user
          relationship: deleted
          target_data_element: cloud user
    - name: user account enable
      type: activity
      relationships:
        - source_data_element: user
          relationship: enabled
          target_data_element: user
    - name: user account disable
      type: activity
      relationships:
        - source_data_element: user
          relationship: disabled
          target_data_element: user
    - name: user account lock
      type: activity
      relationships:
        - source_data_element: user
          relationship: locked
          target_data_element: user
    - name: user account unlock
      type: activity
      relationships:
        - source_data_element: user
          relationship: unlocked
          target_data_element: user
    - name: user account modification
      type: activity
      relationships:
        - source_data_element: user
          relationship: requested modification
          target_data_element: user
        - source_data_element: user
          relationship: modified
          target_data_element: user
        - source_data_element: user
          relationship: granted access
          target_data_element: user
        - source_data_element: user
          relationship: removed access
          target_data_element: user
    - name: user account logon
      type: activity
      relationships:
        - source_data_element: user
          relationship: logged into
          target_data_element: application
        - source_data_element: local user
          relationship: logged onto
          target_data_element: endpoint
        - source_data_element: domain user
          relationship: logged onto
          target_data_element: endpoint
        - source_data_element: cloud user 
          relationship: logged onto #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
        - source_data_element: cloud user
          relationship: console logged onto #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
    - name: user account logoff
      type: activity
      relationships:
        - source_data_element: user
          relationship: logged off from
          target_data_element: application
        - source_data_element: local user
          relationship: logged offfrom
          target_data_element: endpoint
        - source_data_element: domain user
          relationship: logged off from #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: endpoint
        - source_data_element: cloud user
          relationship: logged off from #TBD - how to specify collection-layer (cloud) centric relationships?
          target_data_element: cloud environment
  references:
    - https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/security-principals
- name: Scheduled Task
  definition: Information about scheduled work that the Task Scheduler service performs.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: scheduled task creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely created #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely deleted #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task enable
      type: activity
      relationships:
        - source_data_element: user
          relationship: enabled
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely enabled #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: scheduled task disable
      type: activity
      relationships:
        - source_data_element: user
          relationship: disabled
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely disabled #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
    - name: schedule task modification
      type: activity
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: scheduled task
        - source_data_element: process
          relationship: remotely modified #TBD - how to specify collection-layer (network) centric relationships?
          target_data_element: scheduled task
  references:
    - https://docs.microsoft.com/en-us/windows/win32/taskschd/tasks
- name: DNS
  definition: Information about the Domain Name System (DNS) protocol that provides resources (Such as computers or services) names-to- IP address mapping name resolution services.
  collection_layers:
    - host
    - network
  platforms:
    - Windows
  contributors: 
    - ATT&CK
    - CTID
  data_components:
    - name: dns query execution
      type: activity
      relationships:
        - source_data_element: process
          relationship: executed
          target_data_element: dns query
  references:
    - https://docs.microsoft.com/en-us/windows-server/networking/dns/dns-top
- name: Network share
  definition: Information associated with computer resources made available from one host to other hosts on a computer network.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  data_components:
    - name: exported network shares #TBD - how to specify collection-layer (linux, macos) centric components?
      type: information
    - name: network share creation
      type: activity
      relationships:
        - source_data_element: user
          relationship: created
          target_data_element: network share
        - source_data_element: process
          relationship: created
          target_data_element: network share
        - source_data_element: process
          relationship: created
          target_data_element: smb network share
        - source_data_element: process
          relationship: created
          target_data_element: nfs network share
    - name: network share deletion
      type: activity
      relationships:
        - source_data_element: user
          relationship: deleted
          target_data_element: network share
        - source_data_element: process
          relationship: deleted
          target_data_element: network share
        - source_data_element: process
          relationship: deleted
          target_data_element: smb network share
        - source_data_element: process
          relationship: deleted
          target_data_element: nfs network share
    - name: network share modification
      type: activity
      relationships:
        - source_data_element: user
          relationship: modified
          target_data_element: network share
        - source_data_element: process
          relationship: modified
          target_data_element: network share
        - source_data_element: process
          relationship: modified
          target_data_element: smb network share
        - source_data_element: process
          relationship: modified
          target_data_element: nfs network share
    - name: network share access
      type: activity
      relationships:
        - source_data_element: user
          relationship: accessed
          target_data_element: network share
        - source_data_element: process
          relationship: accessed
          target_data_element: network share
- name: firmware
  definition: Information associated with computer software that provides the low-level control for a device's specific hardware.
  collection_layers:
    - host
  platforms:
    - Windows
    - Linux
    - MacOS
  data_components:
    - name: modification
      type: activity
      description: The firmware of a system component was modified.
        - source_data_element: user
          relationship: modified
          target_data_element: firmware
        - source_data_element: process
          relationship: modified
          target_data_element: network share
    - name: acpi tables
      type: information
      description: Firmware ACPI metadata and content. 
    - name: bios
      type: information
      description: Information (e.g., key/value pairs) extracted from the BIOS on an endpoint.
    - name: smbios
      type: information
      description: Information about the System Management BIOS (SMBIOS) on an endpoint.